<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=11" />
  <meta name="generator" content="Doxygen 1.12.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NEML2: main</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <script type="text/javascript" src="clipboard.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
window.MathJax = {
  loader: {load: ['[tex]/ams', '[tex]/physics', '[tex]/boldsymbol']},
  tex: {packages: {'[+]': ['ams', 'physics', 'boldsymbol']},
        tags: 'ams'}
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-tabs.js" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
  <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
  <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
  <!-- Demo animations -->
  <script type="text/javascript" src="anime.min.js"></script>
  <script type="text/javascript" src="work-dispatcher.js"></script>
  <script type="text/javascript" src="static-hybrid-scheduler.js"></script>
  <script type="text/javascript" src="simple-scheduler-demo.js"></script>
  <script type="text/javascript" src="static-hybrid-scheduler-demo.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init();
    DoxygenAwesomeParagraphLink.init();
    DoxygenAwesomeInteractiveToc.init();
    DoxygenAwesomeTabs.init();
    SimpleSchedulerDemo.init();
    StaticHybridSchedulerDemo.init();
  </script>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr id="projectrow">
              <td id="projectalign">
                <div id="projectname">NEML2<span
                    id="projectnumber">&#160;2.0.0</span>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md__2home_2runner_2work_2neml2_2neml2_2doc_2content_2tutorials_2models_2running__your__first__model_2main.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">main</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1 empty">
    <ul>
      <li class="level2">
        <a href="#autotoc_md111">Problem description</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md112">Searching for available models</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md113">Writing the input file</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md114">Choosing the frontend</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md115">Loading a model from the input file</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md116">Model structure and forward operators</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md117">Evaluating the model</a>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><p>@insert-title:tutorials-models-running-your-first-model</p>
<h2><a class="anchor" id="autotoc_md111"></a>
Problem description</h2>
<p>Let us start with the simplest example for solid mechanics. Consider a solid material whose elastic behavior (mapping from strain \( \boldsymbol{\varepsilon} \) to stress \( \boldsymbol{\sigma} \), or vice versa) can be described as   </p><p class="formulaDsp">
\[
  \boldsymbol{\sigma} = 3 K \operatorname{vol} \boldsymbol{\varepsilon} + 2 G \operatorname{dev} \boldsymbol{\varepsilon},
\]
</p>
<p> where \( K \) is the bulk modulus, and \( G \) is the shear modulus.</p>
<h2><a class="anchor" id="autotoc_md112"></a>
Searching for available models</h2>
<p>All available material models are listed in the <a class="el" href="syntax-models.html">syntax documentation</a>. The documentation of each model provides a brief description, followed by a list of input file options. Each option has a short description right next to it, and can be expanded to show additional details.</p>
<p>There is an existing model that solves this exact problem: <a class="el" href="syntax-models.html#linearisotropicelasticity">LinearIsotropicElasticity</a>. The syntax documentation lists the input file options associated with this model.</p>
<h2><a class="anchor" id="autotoc_md113"></a>
Writing the input file</h2>
<p>As explained in the syntax documentation for <a class="el" href="syntax-models.html#linearisotropicelasticity">LinearIsotropicElasticity</a>, the option "strain" is used to specify the name of the variable for the elastic strain, and the option "stress" is used to specify the name of the variable for the stress. The options "coefficients" and "coefficient_types" are used to specify the values of the parameters, in this case \( K \) and \( G \).</p>
<p>Using these information, the input file for constructing this model can be composed as:</p>
<p>@list-input:running_your_first_model/input.i:Models/my_model</p>
<h2><a class="anchor" id="autotoc_md114"></a>
Choosing the frontend</h2>
<p>There are three common ways of interacting with NEML2 input files:</p><ul>
<li>Calling the appropriate APIs in a C++ program</li>
<li>Calling the appropriate APIs in a Python script</li>
<li>Using the NEML2 Runner</li>
</ul>
<p>These methods are discussed in the <a class="el" href="tutorials-getting-started.html">getting started guide</a>. In this set of tutorials, the C++ example code and the Python script example code are shown side-by-side with tabs, and in most cases the C++ APIs and the Python APIs have a nice one-to-one correspondance.</p>
<h2><a class="anchor" id="autotoc_md115"></a>
Loading a model from the input file</h2>
<p>The following code parses the given input file named "input.i" and retrieves a Model named "my_model". Once retrieved, we can print out a summary of the model by streaming it to the console:</p>
<div class="tabbed"></div><div class="tabbed"><ul>
<li><p class="startli"><b class="tab-title">C++</b> @list:cpp:running_your_first_model/ex1.cxx</p>
<p class="startli">Output: @insert-output:ex1</p>
</li>
<li><p class="startli"><b class="tab-title">Python</b> @list:python:running_your_first_model/ex2.py</p>
<p class="startli">Output: @insert-output:ex2</p>
</li>
</ul>
</div><div class="tabbed"></div><p>The summary includes information about the model's name, input variables, output variables, parameters, and buffers (if any). Note that the variables and parameters are additionally marked with tensor types surrounded by square brackets, i.e., <code>[SR2]</code> and <code>[Scalar]</code>. These are NEML2's primitive tensor types which will be extensively discussed in another set of tutorials (<a class="el" href="tutorials-tensors.html">Tensors</a>).</p>
<h2><a class="anchor" id="autotoc_md116"></a>
Model structure and forward operators</h2>
<p>Before going over model evaluation, let us zoom out from this particular example and briefly discuss the structure of NEML2 models.</p>
<p>All NEML2 models, including this simple elasticity model under consideration, take the following general form   </p><p class="formulaDsp">
\[
  y = f(x; p, b),
\]
</p>
<p> where \( x \) and \( y \) are respectively sets of input and output variables, \( p \) is the set of parameters, and \( b \) is the set of buffers. The utilities of parameters and buffers will be discussed in another <a class="el" href="tutorials-models-model-parameters.html">tutorial</a>. The forward operator \( f \) is responsible for mapping from input variables \( x \) to \( y \). NEML2 provides three forward operators for all models:</p><ul>
<li><a class="el" href="classneml2_1_1Model.html#a818d8bddacb8d16d744559cb1578f24a" title="Convenient shortcut to construct and return the model value.">neml2::Model::value</a> calculates the output variables, i.e., \( y = f(x; p, b) \).</li>
<li><a class="el" href="classneml2_1_1Model.html#adb328987d25d815b33a8b32fae343460" title="Convenient shortcut to construct and return the derivative.">neml2::Model::dvalue</a> calculates the derivatives of the output variables with respect to the input variables, i.e., \( \pdv{y}{x} = \pdv{f(x; p, b)}{x} \).</li>
<li><a class="el" href="classneml2_1_1Model.html#a36f5d1803dee05808b028ab119887aff" title="Convenient shortcut to construct and return the model value and its derivative.">neml2::Model::value_and_dvalue</a> calculates both the output variables and their derivatives.</li>
</ul>
<p>All three forward operators take a map/dictionary of variable values as input and return the requested output variables and/or their derivatives.</p>
<p>In addition to these standard forward operators, some models in NEML2 also support calculating second derivatives. Three additional forward operators are provided to request second derivatives:</p><ul>
<li><a class="el" href="classneml2_1_1Model.html#a61acb2cb0a63326a01ed4e93e0fa8118" title="Convenient shortcut to construct and return the model&#39;s second derivative.">neml2::Model::d2value</a></li>
<li><a class="el" href="classneml2_1_1Model.html#a9c22b18d63883cc22d4a68e83731c459" title="Convenient shortcut to construct and return the model&#39;s first and second derivative.">neml2::Model::dvalue_and_d2value</a></li>
<li><a class="el" href="classneml2_1_1Model.html#a805ebcb1bf7243cfac095512f2335670" title="Convenient shortcut to construct and return the model&#39;s value, first and second derivative.">neml2::Model::value_and_dvalue_and_d2value</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md117"></a>
Evaluating the model</h2>
<p>Model evaluation consists of two simple steps:</p><ol type="1">
<li>Specify the input variable values</li>
<li>Call the appropriate forward operator</li>
</ol>
<p>In this example, the elasticity model can be evaluated using the following code:</p>
<dl class="section note"><dt>Note</dt><dd>Note that <code>set_default_dtype(kFloat64)</code> is used to change the default precision to double precision.</dd></dl>
<div class="tabbed"></div><div class="tabbed"><ul>
<li><p class="startli"><b class="tab-title">C++</b> @list:cpp:running_your_first_model/ex3.cxx</p>
<p class="startli">Output: @insert-output:ex3</p>
</li>
<li><p class="startli"><b class="tab-title">Python</b> @list:python:running_your_first_model/ex4.py</p>
<p class="startli">Output: @insert-output:ex4</p>
</li>
</ul>
</div><div class="tabbed"></div><p>@insert-page-navigation </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
